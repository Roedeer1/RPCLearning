sb.append("SELECT * FROM (SELECT A.*,ROWNUM RN FROM ").append("(SELECT ric.VALUE ric ,").append("mic_val.VALUE mic ,").append("cla_root_f.val root ,").append("der.contract_date ff_contract_date ,").append("tkr_sym.VALUE ff_ticker_symbol ,").append("trad_sym.VALUE ff_trading_symbol ,").append("der.sd series_desc ").append("FROM ").append("(SELECT VALUE ,").append("ast_for_nda_id ").append("FROM IDENTIFIER ").append("WHERE pro_nda_id = 1786 ").append("AND end_date IS NULL ").append(") ric ").append("JOIN").append("(SELECT nda_id ,cla_category_nda_id ,cla_display_type_nda_id FROM ASSET ").append("WHERE cLA_ASSET_CLASS_NDA_ID = 1000001101 AND CLA_STATE_NDA_ID = 41 ").append("AND cla_display_type_nda_id != 2000053932 ) ast ").append("ON ric.ast_for_nda_id = ast.nda_id ").append("JOIN ").append("(SELECT NDA_Id ,contract_date ,series_description sd FROM derivative ").append("WHERE contract_date IS NOT NULL AND cla_trading_style_nda_id = 114609) der ").append("ON ast.nda_id = der.nda_id ").append("JOIN ").append("(SELECT m.ast_for_nda_id ast_nda_id ,c.VALUE ,m.create_by ,m.create_date ,c.nda_id ,m.modify_by ,m.modify_date ").append("FROM classifier_map m ").append("JOIN classifier c ").append("ON m.cla_against_nda_id = c.nda_id AND m.erd_cma_type_nda_id = 81960 AND m.end_date IS NULL AND eit_define_by_nda_id = 81959 ").append("AND c.nda_id IN (").append(rcs).append(")) rcs ON ast.nda_id = rcs.ast_nda_id JOIN ").append("(SELECT seg.ast_nda_id ,seg.ese_nda_id ,es.nda_id es_nda_id ,es.cla_mic_nda_id ,c.nda_id c_nda_id ,c.VALUE ").append("FROM segment_rship seg JOIN exchange_segment es ON seg.ESE_NDA_ID = es.NDA_ID ").append("JOIN classifier c ON es.CLA_MIC_NDA_ID = c.nda_id ").append("AND c.end_date IS NULL AND c.eit_define_by_nda_id = 20200 AND seg.PRO_NDA_ID = 81462 AND seg.END_DATE IS NULL ").append("AND c.nda_id in (").append(exchange).append(")) mic_val ON ast.nda_id = mic_val.ast_nda_id JOIN ").append("(SELECT ast_for_nda_id ast ,cla_against_nda_id ,erd_cma_type_value_d FROM classifier_map ").append("WHERE erd_cma_type_nda_id = 12536 AND end_date IS NULL) cma_f ON ast.nda_id = cma_f.ast ").append("LEFT JOIN (SELECT nda_id ,VALUE val ,meaning mean FROM classifier WHERE eit_define_by_nda_id = 4325 ").append("AND end_date IS NULL) cla_root_f ON cma_f.cla_against_nda_id = cla_root_f.nda_id JOIN ").append("(SELECT ast_for_nda_id ,VALUE FROM NAME WHERE pro_nda_id = 32966 AND end_date IS NULL) tkr_sym ").append("ON ast.nda_id = tkr_sym.ast_for_nda_id LEFT JOIN (SELECT ast_for_nda_id ,VALUE FROM NAME ").append("WHERE pro_nda_id = 115166 AND end_date IS NULL) trad_sym ON ast.nda_id = trad_sym.ast_for_nda_id) A ").append("WHERE ROWNUM <= ?) WHERE RN >= ?");